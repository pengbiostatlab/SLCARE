<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SLCARE">
<title>SLCARE • SLCARE</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="SLCARE">
<meta property="og:description" content="SLCARE">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SLCARE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/SLCARE.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Data_format.html">Format of input dataset</a>
    <a class="dropdown-item" href="../articles/Estimation_procedure.html">Estimation procedure</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/qyxxx/SLCARE/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>SLCARE</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/qyxxx/SLCARE/blob/HEAD/vignettes/SLCARE.Rmd" class="external-link"><code>vignettes/SLCARE.Rmd</code></a></small>
      <div class="d-none name"><code>SLCARE.Rmd</code></div>
    </div>

    
    
<p><code>SLCARE</code> models recurrent events data based on a
semi-parametric multiplicative model.</p>
<div class="section level2">
<h2 id="data-and-model-assumption">Data and Model assumption<a class="anchor" aria-label="anchor" href="#data-and-model-assumption"></a>
</h2>
<p>Let <span class="math inline">\(T_{i} ^{(j)}\)</span> denote time to
the <span class="math inline">\(j^{th}\)</span> recurrent event, <span class="math inline">\(\tilde{Z} _{i}\)</span> denote a <span class="math inline">\(p \times 1\)</span> vector of time-independent
covariates, <span class="math inline">\(C_{i}\)</span> censoring
time.</p>
<p>Counting process for recurrent events: <span class="math display">\[
N_{i} ^{*} (t) = \sum _{j = 1} ^{\infty} I(T_{i} ^{(j)} \leq t), i =
1,\cdots ,n
\]</span> Assume <span class="math inline">\(N_{i} ^{*} (t)\)</span> is
a non-stationary Poisson process with intensity function: <span class="math display">\[
\lambda _{i} (t) = \sum _{k = 1} ^{K} I (\xi _{i} = k) \times \lambda
_{0} (t) \times W_{i} \times \eta _{0,k} \times exp(\tilde{Z} _{i} ^{T}
\tilde{\beta} _{0,k})\tag{1}
\]</span> Where:</p>
<p><span class="math inline">\(K\)</span> : a pre-determined number of
latent class</p>
<p><span class="math inline">\(\xi _{i}\)</span>: un-observable latent
class membership</p>
<p><span class="math inline">\(\lambda _{0} (t)\)</span>: an
unspecified, continuous, non-negative baseline intensity function shared
among different latent class</p>
<p><span class="math inline">\(W_{i}\)</span>: a positive
subject-specific latent variable independent of <span class="math inline">\((\xi, \tilde{Z}, C)\)</span>, <span class="math inline">\(W_{i}\)</span> offers the flexibility to
accommodate individual difference with a larger or smaller value
indicating more or less frequent occurence of recurrent events.</p>
<p>Unknown class-specific parameters:</p>
<p><span class="math inline">\(\eta _{0,k}\)</span> Captures the class-k
scale shift in the baseline intensity function</p>
<p><span class="math inline">\(\tilde{\beta} _{0,k}\)</span> represents
the class-k corvariate effects on the intensity function</p>
<p>To ensure the identifiability of <span class="math inline">\(\lambda
_{0} (t)\)</span> And <span class="math inline">\(\eta _{0,k}\)</span>
in (1), assume <span class="math inline">\(E(W_{i} | \tilde{Z}_{i} , \xi
_{i} = k) = 1\)</span> for <span class="math inline">\(k = 1, \cdots,
K\)</span> and impose the constraint: <span class="math display">\[
\int _{0} ^{v^{*}} \lambda _{0} (t) dt = 1 \tag{2}
\]</span> where <span class="math inline">\(v^{*}\)</span> is a
predetermined constant</p>
<ul>
<li>In practice, it may be chosen to be slightly smaller than the upper
bound of <span class="math inline">\(C_{i}\)</span> ’s support</li>
<li>Or it would only imply a scale shift to <span class="math inline">\(\lambda _0 (t)\)</span> by a constant with <span class="math inline">\(\eta _{0,k}\)</span> and <span class="math inline">\(\tilde{\beta} _{0,k}\)</span> remaining the
same</li>
</ul>
<p>To address the difficulty with the unobservable latent class
membership, assume a multinomial logistic regression model for <span class="math inline">\(\xi _{i}\)</span> : <span class="math display">\[
P(\xi _{i} = k | \tilde{Z} _{i}) = p_{k} (\alpha _{0} , \tilde{Z} _{i})
= \frac{exp(\tilde{Z} _{i} ^{T} \alpha _{0,k})}{\sum_{k =
1}^{K}exp(\tilde{Z} _{i} ^{T} \alpha _{0,k}) } , k = 1, \cdots, K
\tag{3}
\]</span> Where: <span class="math inline">\(\alpha _0 = (\alpha _{0,1}
^{K}, \dots, \alpha _{0,K}^{K})^{T}\)</span></p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>We will illustrate the usage of <code>SLCARE</code> with
<code>SLCARE_simdat</code> from the <code>SLCARE</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/qyxxx/SLCARE" class="external-link">SLCARE</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"SLCARE_simdat"</span>, package <span class="op">=</span> <span class="st">"SLCARE"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">SLCARE_simdat</span><span class="op">)</span></span>
<span><span class="co">#&gt;       ID time event x1        x2</span></span>
<span><span class="co">#&gt; 1 UOM054   65     1  0 0.5555556</span></span>
<span><span class="co">#&gt; 2 UOM054  940     1  0 0.5555556</span></span>
<span><span class="co">#&gt; 3 UOM054 2420     1  0 0.5555556</span></span>
<span><span class="co">#&gt; 4 UOM054 2475     1  0 0.5555556</span></span>
<span><span class="co">#&gt; 5 UOM054 2650     1  0 0.5555556</span></span>
<span><span class="co">#&gt; 6 UOM054 3830     1  0 0.5555556</span></span></code></pre></div>
<div class="section level3">
<h3 id="fit-the-model-with-k-2-with-frailty-w-1-">Fit the model with K = 2 with frailty <span class="math inline">\(W
= 1\)</span>.<a class="anchor" aria-label="anchor" href="#fit-the-model-with-k-2-with-frailty-w-1-"></a>
</h3>
<p>Note that by default, the initial values in the iteration based
estimation procedure are derived with K- means and a multiplicative
intensity model studies by Wang et al. (2001) using the reReg()
function. See <code><a href="../reference/get_initial.html">SLCARE::get_initial()</a></code> for details.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SLCARE.html">SLCARE</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">SLCARE_simdat</span>, K<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><code>SLCARE</code> will return to a list containing:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">model1</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "alpha"                   "beta"                   </span></span>
<span><span class="co">#&gt;  [3] "convergeloss"            "PosteriorPrediction"    </span></span>
<span><span class="co">#&gt;  [5] "EstimatedTau"            "ModelChecking"          </span></span>
<span><span class="co">#&gt;  [7] "est_mu0"                 "Estimated_mu0t"         </span></span>
<span><span class="co">#&gt;  [9] "Estimated_Mean_Function" "RelativeEntropy"        </span></span>
<span><span class="co">#&gt; [11] "InitialAlpha"            "InitialBeta"</span></span></code></pre></div>
<p>We can check the point estimates for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model1</span><span class="op">$</span><span class="va">alpha</span></span>
<span><span class="co">#&gt;               x1        x2</span></span>
<span><span class="co">#&gt; class1 0.0000000  0.000000</span></span>
<span><span class="co">#&gt; class2 0.2204357 -3.736727</span></span>
<span><span class="va">model1</span><span class="op">$</span><span class="va">beta</span></span>
<span><span class="co">#&gt;        (Intercept)        x1         x2</span></span>
<span><span class="co">#&gt; class1    2.496767 -0.110277  0.1679575</span></span>
<span><span class="co">#&gt; class2    3.175178 -0.141808 -5.5362092</span></span></code></pre></div>
<p>We can check the posterior prediction for observed events for
subjects of interest</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model1</span><span class="op">$</span><span class="va">PosteriorPrediction</span></span>
<span><span class="co">#&gt;        ID PosteriorPrediction</span></span>
<span><span class="co">#&gt; 1  UOM054          10.5227224</span></span>
<span><span class="co">#&gt; 2   EM015          11.5014781</span></span>
<span><span class="co">#&gt; 3    G078          11.4903563</span></span>
<span><span class="co">#&gt; 4  UOM048          11.9388759</span></span>
<span><span class="co">#&gt; 5    G050          11.1886724</span></span>
<span><span class="co">#&gt; 6    G058           3.8500141</span></span>
<span><span class="co">#&gt; 7   EM037           5.7373952</span></span>
<span><span class="co">#&gt; 8    G052           1.8489939</span></span>
<span><span class="co">#&gt; 9  UOM043           2.3018298</span></span>
<span><span class="co">#&gt; 10   G064          12.2549101</span></span>
<span><span class="co">#&gt; 11  EM036           1.7865768</span></span>
<span><span class="co">#&gt; 12 UOM003           7.2927102</span></span>
<span><span class="co">#&gt; 13  EM001           9.6461813</span></span>
<span><span class="co">#&gt; 14 UOM020           5.6180338</span></span>
<span><span class="co">#&gt; 15   G027           6.9236494</span></span>
<span><span class="co">#&gt; 16 UOM023          12.1637705</span></span>
<span><span class="co">#&gt; 17 UOM051           9.7369634</span></span>
<span><span class="co">#&gt; 18   G036          12.0859251</span></span>
<span><span class="co">#&gt; 19   G051          13.4306809</span></span>
<span><span class="co">#&gt; 20 UOM055          12.0733739</span></span>
<span><span class="co">#&gt; 21   G070           5.6079467</span></span>
<span><span class="co">#&gt; 22 UOM009           4.5591882</span></span>
<span><span class="co">#&gt; 23   G047          10.3564909</span></span>
<span><span class="co">#&gt; 24   G007          11.3667516</span></span>
<span><span class="co">#&gt; 25   G009          10.5893497</span></span>
<span><span class="co">#&gt; 26   G004           2.3224480</span></span>
<span><span class="co">#&gt; 27 UOM040          17.3172396</span></span>
<span><span class="co">#&gt; 28  EM013           3.1650867</span></span>
<span><span class="co">#&gt; 29   G066           1.7884215</span></span>
<span><span class="co">#&gt; 30   G021          11.1295757</span></span>
<span><span class="co">#&gt; 31   G061           8.0095335</span></span>
<span><span class="co">#&gt; 32 UOM031           0.8026416</span></span>
<span><span class="co">#&gt; 33  EM044           9.7559038</span></span>
<span><span class="co">#&gt; 34   G015           5.7280014</span></span>
<span><span class="co">#&gt; 35  EM018          12.8902131</span></span>
<span><span class="co">#&gt; 36 UOM050          13.1332526</span></span>
<span><span class="co">#&gt; 37   G005           8.0697634</span></span>
<span><span class="co">#&gt; 38   G003          10.4539334</span></span>
<span><span class="co">#&gt; 39   G018           5.0996630</span></span>
<span><span class="co">#&gt; 40   G057          11.7181383</span></span>
<span><span class="co">#&gt; 41   G072          11.6051441</span></span>
<span><span class="co">#&gt; 42 UOM005          13.1737497</span></span>
<span><span class="co">#&gt; 43   G019           4.0456816</span></span>
<span><span class="co">#&gt; 44 UOM025           9.4886388</span></span>
<span><span class="co">#&gt; 45   G065           2.1372540</span></span>
<span><span class="co">#&gt; 46  EM014          10.6922976</span></span>
<span><span class="co">#&gt; 47   G079           2.8322107</span></span>
<span><span class="co">#&gt; 48 UOM007           3.1004627</span></span>
<span><span class="co">#&gt; 49   G048           7.6133885</span></span>
<span><span class="co">#&gt; 50   G080          11.6309883</span></span></code></pre></div>
<p>We can check the posterior probability of latent class membership</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model1</span><span class="op">$</span><span class="va">EstimatedTau</span></span>
<span><span class="co">#&gt;        ID      class1       class2</span></span>
<span><span class="co">#&gt; 1  UOM054 0.999999641 3.588689e-07</span></span>
<span><span class="co">#&gt; 2   EM015 0.999999270 7.296420e-07</span></span>
<span><span class="co">#&gt; 3    G078 0.998646435 1.353565e-03</span></span>
<span><span class="co">#&gt; 4  UOM048 1.000000000 3.410495e-13</span></span>
<span><span class="co">#&gt; 5    G050 0.998840723 1.159277e-03</span></span>
<span><span class="co">#&gt; 6    G058 0.437239412 5.627606e-01</span></span>
<span><span class="co">#&gt; 7   EM037 0.559913306 4.400867e-01</span></span>
<span><span class="co">#&gt; 8    G052 0.009863978 9.901360e-01</span></span>
<span><span class="co">#&gt; 9  UOM043 0.325872654 6.741273e-01</span></span>
<span><span class="co">#&gt; 10   G064 1.000000000 9.013150e-25</span></span>
<span><span class="co">#&gt; 11  EM036 0.001336693 9.986633e-01</span></span>
<span><span class="co">#&gt; 12 UOM003 0.188217597 8.117824e-01</span></span>
<span><span class="co">#&gt; 13  EM001 0.948642553 5.135745e-02</span></span>
<span><span class="co">#&gt; 14 UOM020 1.000000000 3.327574e-10</span></span>
<span><span class="co">#&gt; 15   G027 0.999976786 2.321358e-05</span></span>
<span><span class="co">#&gt; 16 UOM023 0.999999995 5.446992e-09</span></span>
<span><span class="co">#&gt; 17 UOM051 0.776284012 2.237160e-01</span></span>
<span><span class="co">#&gt; 18   G036 0.714972850 2.850272e-01</span></span>
<span><span class="co">#&gt; 19   G051 1.000000000 4.054462e-14</span></span>
<span><span class="co">#&gt; 20 UOM055 0.910532662 8.946734e-02</span></span>
<span><span class="co">#&gt; 21   G070 0.681826745 3.181733e-01</span></span>
<span><span class="co">#&gt; 22 UOM009 0.547115965 4.528840e-01</span></span>
<span><span class="co">#&gt; 23   G047 0.359803746 6.401963e-01</span></span>
<span><span class="co">#&gt; 24   G007 0.983611339 1.638866e-02</span></span>
<span><span class="co">#&gt; 25   G009 0.554658656 4.453413e-01</span></span>
<span><span class="co">#&gt; 26   G004 0.055220951 9.447790e-01</span></span>
<span><span class="co">#&gt; 27 UOM040 0.319408186 6.805918e-01</span></span>
<span><span class="co">#&gt; 28  EM013 0.546855255 4.531447e-01</span></span>
<span><span class="co">#&gt; 29   G066 0.012265950 9.877341e-01</span></span>
<span><span class="co">#&gt; 30   G021 0.969492976 3.050702e-02</span></span>
<span><span class="co">#&gt; 31   G061 0.290533287 7.094667e-01</span></span>
<span><span class="co">#&gt; 32 UOM031 0.618818075 3.811819e-01</span></span>
<span><span class="co">#&gt; 33  EM044 0.999824606 1.753943e-04</span></span>
<span><span class="co">#&gt; 34   G015 0.999977573 2.242684e-05</span></span>
<span><span class="co">#&gt; 35  EM018 0.999976933 2.306671e-05</span></span>
<span><span class="co">#&gt; 36 UOM050 1.000000000 3.290086e-11</span></span>
<span><span class="co">#&gt; 37   G005 0.433093210 5.669068e-01</span></span>
<span><span class="co">#&gt; 38   G003 0.702729729 2.972703e-01</span></span>
<span><span class="co">#&gt; 39   G018 0.545514459 4.544855e-01</span></span>
<span><span class="co">#&gt; 40   G057 0.999999892 1.077511e-07</span></span>
<span><span class="co">#&gt; 41   G072 0.612486202 3.875138e-01</span></span>
<span><span class="co">#&gt; 42 UOM005 1.000000000 5.818215e-13</span></span>
<span><span class="co">#&gt; 43   G019 0.447460375 5.525396e-01</span></span>
<span><span class="co">#&gt; 44 UOM025 0.999751903 2.480969e-04</span></span>
<span><span class="co">#&gt; 45   G065 0.309831911 6.901681e-01</span></span>
<span><span class="co">#&gt; 46  EM014 0.997311331 2.688669e-03</span></span>
<span><span class="co">#&gt; 47   G079 0.748248625 2.517514e-01</span></span>
<span><span class="co">#&gt; 48 UOM007 0.534013300 4.659867e-01</span></span>
<span><span class="co">#&gt; 49   G048 0.221051811 7.789482e-01</span></span>
<span><span class="co">#&gt; 50   G080 0.999999626 3.742849e-07</span></span></code></pre></div>
<p>We can check the plot for model checking</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model1</span><span class="op">$</span><span class="va">ModelChecking</span></span></code></pre></div>
<p><img src="SLCARE_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>We can check the plot for <span class="math inline">\(\hat{\mu}
_{0}(t)\)</span></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model1</span><span class="op">$</span><span class="va">Estimated_mu0t</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="SLCARE_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>We can check the <span class="math inline">\(\hat{\mu} _{0}
(t)\)</span> at specific time points. For example, let <span class="math inline">\(t = 100, 1000, 5000\)</span></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model1</span><span class="op">$</span><span class="fu">est_mu0</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1000</span>, <span class="fl">5000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.06086907 0.17089670 0.70936436</span></span></code></pre></div>
<p>We can check the plot of estimated mean function</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model1</span><span class="op">$</span><span class="va">Estimated_Mean_Function</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="SLCARE_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>We can check the relative entropy for the fitted model</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model1</span><span class="op">$</span><span class="va">RelativeEntropy</span></span>
<span><span class="co">#&gt; [1] 0.5468913</span></span></code></pre></div>
<p>We can check the initial values for iteration based estimation
procedure</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model1</span><span class="op">$</span><span class="va">InitialAlpha</span></span>
<span><span class="co">#&gt;                x1        x2</span></span>
<span><span class="co">#&gt; class1  0.0000000  0.000000</span></span>
<span><span class="co">#&gt; class2 -0.4984874 -2.447667</span></span>
<span><span class="va">model1</span><span class="op">$</span><span class="va">InitialBeta</span></span>
<span><span class="co">#&gt;        intercept         x1          x2</span></span>
<span><span class="co">#&gt; class1  2.563970 -0.2441563  0.06202144</span></span>
<span><span class="co">#&gt; class2  2.125367  0.0107472 -1.09947581</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fit-the-model-with-k-2-with-frailty-w-1-and-apply-self-defined-initial-values-in-estimation-procedure-">Fit the model with K = 2 with frailty <span class="math inline">\(W
= 1\)</span> and apply self-defined initial values in estimation
procedure.<a class="anchor" aria-label="anchor" href="#fit-the-model-with-k-2-with-frailty-w-1-and-apply-self-defined-initial-values-in-estimation-procedure-"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.5</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="op">-</span><span class="fl">4</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.3</span>, <span class="fl">1.5</span>, <span class="op">-</span><span class="fl">0.2</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">2.5</span>,  <span class="fl">0.1</span>, <span class="fl">0.2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span> , ncol <span class="op">=</span> <span class="fl">2</span><span class="op">+</span><span class="fl">1</span> , byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SLCARE.html">SLCARE</a></span><span class="op">(</span><span class="va">alpha</span>, <span class="va">beta</span>, dat <span class="op">=</span> <span class="va">SLCARE_simdat</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fit-the-model-with-k-2-with-frailty-w-sim-gamma33-and-apply-self-defined-initial-values-in-estimation-procedure-">Fit the model with K = 2 with frailty <span class="math inline">\(W
\sim gamma(3,3)\)</span> and apply self-defined initial values in
estimation procedure.<a class="anchor" aria-label="anchor" href="#fit-the-model-with-k-2-with-frailty-w-sim-gamma33-and-apply-self-defined-initial-values-in-estimation-procedure-"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SLCARE.html">SLCARE</a></span><span class="op">(</span><span class="va">alpha</span>, <span class="va">beta</span>, dat <span class="op">=</span> <span class="va">SLCARE_simdat</span>, gamma <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>We may also calculate bootstrap standard errors by using
<code>boot</code> argument</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># model4 &lt;- SLCARE(alpha, beta, dat = SLCARE_simdat, boot = 100)</span></span></code></pre></div>
<p>We can check bootstrap standard errors</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># model4$alpha_bootse</span></span>
<span><span class="co"># model4$beta_bootse</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Qi Yu, Limin Peng.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
